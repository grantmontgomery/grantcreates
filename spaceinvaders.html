<!DOCTYPE html>
<head>
    <link rel="stylesheet" href="spaceinvaders.css">

</head>


<body>
    <div id="background">
        <div id="hero"></div>
        <div id="enemies"></div>
        <div id="missles"></div>
    </div>
    <script>
        let hero = {
            top: 700,
            left: 550,
        };
        let missles = [];

        let enemies = [
            { left: 200, top: 100 },
            { left: 300, top: 100 },
            { left: 400, top: 100 },
            { left: 500, top: 100 },
            { left: 600, top: 100 },
            { left: 700, top: 100 },
            { left: 800, top: 100 },
            { left: 200, top: 175 },
            { left: 300, top: 175 },
            { left: 400, top: 175 },
            { left: 500, top: 175 },
            { left: 600, top: 175 },
            { left: 700, top: 175 },
            { left: 800, top: 175 },
            { left: 900, top: 175 },
        ];
        
        document.onkeydown = function(e){
            console.log(e.keyCode);
            if (e.keyCode === 37){
                hero.left -= 10;
                moveHero();
            }
            else if (e.keyCode === 39){
                hero.left += 10;
                moveHero();
            }
            else if (e.keyCode === 32){
                missles.push({
                    left: hero.left,
                    top: hero.top,
                })
                shootHero();

            }
        }
    
        // console.log(document);
        function moveHero() {
            document.getElementById('hero').style.left = hero.left + "px";
        }
        function shootHero() {
            document.getElementById('missles').innerHTML = '';
            for (let i = 0; i < missles.length; i++){
                document.getElementById('missles').innerHTML += `<div class='missle' style='left:${missles[i].left}px; top:${missles[i].top}px;'></div>`;
            }
            // missles.forEach(function bruh(missle){
            //     document.getElementById('missles').innerHTML += `<div class='missle' style='left:${missles.indexOf(missle).left}px; top:${missles.indexOf(missle).top}px;'></div>`;
            // })
           
        }
        function misslesfired(){
            for (let i = 0; i < missles.length; i++){
                missles[i].top -= 20;
            }
        }

        function drawEnemies (){
            document.getElementById('enemies').innerHTML = '';
            for (let i = 0; i < enemies.length; i++){
                document.getElementById('enemies').innerHTML += `<div class='enemy' style='left:${enemies[i].left}px; top:${enemies[i].top}px;'></div>`;
            }
        }

        function moveEnemies(){
            for(let i = 0; i < enemies.length; i++){
                enemies[i].top += 2;
            }
        }

        function collisionDetection(){
            for (let enemy = 0; enemy < enemies.length; enemy++){
                for (let missle = 0; missle < missles.length; missle++){
                    console.log("enemies[enemy].top", enemies[enemy].top)
                    if (
                        (missles[missle].top >= enemies[enemy].top + 50) &&
                        (missles[missle].top > enemies[enemy].top) &&
                        (missles[missle].left >= enemies[enemy].left) &&
                        (missles[missle].left <= enemies[enemy].left + 50)
                        ){
                        console.log("HIT!");
                        missles.splice(missle, 1);
                        enemies.splice(enemy, 1);
                    }
                }
            }
        }

        function gameLoop(){
            setTimeout(gameLoop , 50)
            misslesfired();
            shootHero();
            moveEnemies();
            drawEnemies();
            collisionDetection()
        }
        gameLoop();
        //Bonus
        //Move Hero Top/Down
        //Move Enemies Left/Right as they move down.
        //Use different missles
        //have enemies shoot missles
        //Add score
        //Reset

    </script>
</body>